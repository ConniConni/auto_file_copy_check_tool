# コーディング規約および実装ガイドライン

本アプリケーションの実装にあたり、以下のコーディング規約とガイドラインを厳守してください。

## 1. コードスタイルと基本原則
*   **PEP 8準拠:** Pythonの標準スタイルガイド（PEP 8）に従ってください。
*   **Type Hinting (型ヒント) の強制:**
    *   Python 3.10以降の記法を使用してください（例: `Optional[str]` ではなく `str | None`、`List[str]` ではなく `list[str]`）。
    *   すべての関数・メソッドの引数と戻り値に型ヒントを記述してください。
*   **Docstring:**
    *   すべての関数、クラス、メソッドにDocstring（Google Style推奨）を記述してください。
    *   引数、戻り値、送出される例外（Raises）を明記してください。

## 2. パス操作とクロスプラットフォーム対応（最重要）
*   **pathlibの利用:** ファイルパスの操作には **必ず `pathlib.Path` モジュールを使用してください。**
*   **禁止事項:**
    *   `os.path.join` の使用禁止。
    *   文字列結合（`+` や f-string）によるパス生成の禁止。
    *   パス区切り文字（`\` や `/`）のハードコーディング禁止。
*   **実装例:**
    *   NG: `path = base + "/" + folder`
    *   OK: `path = Path(base) / folder`

## 3. 定数管理と構造化
*   **Enumの使用:** 以下の項目は文字列リテラルを散らばらせず、必ず `Enum` クラス（`StrEnum`や`IntEnum`）で定義して管理してください。
    *   動作モード (`OUTGOING`, `INCOMING`)
    *   工程名（`PHASE_030`, `PHASE_040`...）
    *   ディレクトリ名（`INTERNAL`, `EXTERNAL`, `ARTIFACTS` など）
*   **設定クラス:** `config.ini` の内容は、辞書型で回すのではなく、型定義された `Config` データクラス（dataclass）にロードしてから使用してください。

## 4. エラーハンドリングとログ
*   **ログ出力:** `print()` デバッグは禁止です。必ず `logging` モジュールを使用してください。
    *   コンソール表示: ユーザーへの通知（INFO/WARNING）
    *   ファイル出力: 詳細なログ（DEBUG/INFO/ERROR）
*   **例外処理:**
    *   広すぎる例外捕捉（`except Exception:`）は避け、具体的な例外（`PermissionError`, `FileNotFoundError`）を捕捉してください。
    *   ファイル操作時の `PermissionError`（Excelが開かれている場合など）は、`logger.error` でログに残し、**プロセスを終了させずに `continue` で次の処理へ進んでください。**

## 5. UIとロジックの分離
*   コードは可能な限り以下の責務でモジュール（またはクラス）を分けてください。
    1.  **Core Logic:** ファイル検索、フィルタリング、チェック、コピーを行う純粋なロジック。
    2.  **UI/CLI:** ユーザー入力を受け付け、ロジックを呼び出し、結果を表示する部分。
    3.  **Configuration:** 設定ファイル読み込みとバリデーション。

---
